name: PR Source Test

on:
  # pull_request:
  #   branches:
  #     - master
  workflow_dispatch:
  # pull_request_review:
  #   types: [submitted]

jobs:
  analyze-sources:
    # Run only when:
    # 1. A PR review is submitted AND approved
    # 2. The PR is targeting the master branch
    # if: |
    #   github.event.review.state == 'approved' &&
    #   github.event.pull_request.base.ref == 'master'
    runs-on: ubuntu-latest

    steps:
      # - name: Show PR information
      #   run: |
      #     echo "PR Number: ${{ github.event.pull_request.number }}"
      #     echo "This PR was approved by ${{ github.event.review.user.login }}"
      #     echo "Target branch: ${{ github.event.pull_request.base.ref }}"
      #     echo "Source branch: ${{ github.event.pull_request.head.ref }}"

      - name: Checkout code (PR branch)
        uses: actions/checkout@v4

      - name: Detect sources
        id: detect
        run: |
          echo "## List all files in repository"
          ls -la
          
          echo -e "\n## Check if get_ip.py exists"
          if [ -f "get_ip.py" ]; then
            echo "Reading get_ip.py:"
            cat get_ip.py
          else
            echo "File get_ip.py not found"
            echo "Available Python files:"
            find . -type f -name "*.py" | head -20
          fi
